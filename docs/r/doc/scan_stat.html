









<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/img/igraph4.png" type="image/x-icon" />

    <title>igraph R manual pages</title>

    <!-- Bootstrap core CSS -->
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="//fonts.googleapis.com/css?family=Lato:300,400,700"
          rel="stylesheet" type="text/css">
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" href="/fonts/font-mfizz/font-mfizz.css">
    <link href="/css/affix.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">
    <link href="/css/other.css" rel="stylesheet">
    <link href="/fonts/fonts.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements 
         and media queries -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
      <script src="/js/respond.min.js"></script>
    <![endif]-->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1392972-5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-1392972-5');
    </script>

    <link href="/css/manual.css" rel="stylesheet">
  </head>

  <body class="r">
  <div id="wrap">

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle"
                  data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
            <img src="/img/igraph4.svg" width=35> igraph
          </a>
        </div>
        <div class="navbar-collapse collapse">
	  
	  <ul class="nav navbar-nav">
	    <li><a href="/r">| igraph R package</a></li>
	  </ul>
	  
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"
		 role="button" aria-expanded="false">Products
		<span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
		<li>
		  <a href="/r"><i class="icon-fixed-width icon-rlogo"></i>
		    igraph R package</a></li>
		<li>
		  <a href="/python"><i class="icon-fixed-width icon-python"></i>
		    python-igraph</a></li>
		<li>
		  <a href="http://szhorvat.net/mathematica/IGraphM"><i class="icon-fixed-width icon-python"></i>
		    IGraph/M</a></li>
		<li>
		  <a href="/c"><i class="icon-fixed-width icon-c"></i>
		    igraph C library</a></li>
		<li class="divider"></li>
		<li>
		  <a href="https://github.com/igraph/igraphdata">
		    <i class="icon-fixed-width icon-rlogo"></i>
		    igraphdata R package <i class="fa fa-github"></i></a></li>
              </ul>
            </li>
            <li>
              <a href="/news.html"><i class="icon-rss"></i>
		News</a></li>
	    <li><a href="https://github.com/igraph">
	      <i class="icon-github"></i> On github</a></li>
          </ul>
          <!-- <form class="navbar-form navbar-right"> -->
          <!--   <div class="form-group"> -->
          <!--     <input type="text" placeholder="Search docs" -->
	  <!-- 	     class="form-control" size="15"> -->
          <!--   </div> -->
          <!--   <button type="submit" class="btn btn-success"> -->
          <!--     <span class="glyphicon glyphicon-search"></span></button> -->
          <!-- </form> -->
        </div><!--/.navbar-collapse -->
      </div>
    </div>
    
    
    
    <div class="bs-header-outer"><div class="bs-header">
      <div class="container">
        <h1>R igraph manual pages</h1>
        <p class="lead">Use this if you are using igraph from R</p>        
      </div>
    </div></div>

    

    <div class="container bs-docs-container">
<div class="row">
  <div class="col-md-9 col-md-offset-1">
  <div class="bs-docs-section">

    


<h2>Scan statistics on a time series of graphs</h2>

<h3>Description</h3>

<p>Calculate scan statistics on a time series of graphs.
This is done by calculating the local scan statistics for
each graph and each vertex, and then normalizing across the
vertices and across the time steps.
</p>


<h3>Usage</h3>

<pre>
scan_stat(graphs, tau = 1, ell = 0, locality = c("us", "them"), ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>graphs</code></td>
<td>
<p>A list of igraph graph objects. They must be all directed
or all undirected and they must have the same number of vertices.</p>
</td></tr>
<tr valign="top"><td><code>tau</code></td>
<td>
<p>The number of previous time steps to consider for the
time-dependent normalization for individual vertices.  In other words,
the current locality statistics of each vertex will be compared to this
many previous time steps of the same vertex to decide whether it is
significantly larger.</p>
</td></tr>
<tr valign="top"><td><code>ell</code></td>
<td>
<p>The number of previous time steps to consider
for the aggregated scan statistics. This is essentially a smoothing
parameter.</p>
</td></tr>
<tr valign="top"><td><code>locality</code></td>
<td>
<p>Whether to calculate the &lsquo;us&rsquo; or &lsquo;them&rsquo;
statistics.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Extra arguments are passed to <code><a href="local_scan.html">local_scan</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with entries:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>stat</code></td>
<td>
<p>The scan statistics in each time step. It is <code>NA</code>
for the initial <code>tau + ell</code> time steps.</p>
</td></tr>
<tr valign="top"><td><code>arg_max_v</code></td>
<td>
<p>The (numeric) vertex ids for the vertex with
the largest locality statistics, at each time step. It is <code>NA</code>
for the initial <code>tau + ell</code> time steps.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other scan statistics: <code><a href="local_scan.html">local_scan</a></code>
</p>


<h3>Examples</h3>

<pre>
## Generate a bunch of SBMs, with the last one being different
num_t &lt;- 20
block_sizes &lt;- c(10, 5, 5)
p_ij &lt;- list(p = 0.1, h = 0.9, q = 0.9)

P0 &lt;- matrix(p_ij$p, 3, 3)
P0[2, 2] &lt;- p_ij$h
PA &lt;- P0
PA[3, 3] &lt;- p_ij$q
num_v &lt;- sum(block_sizes)

tsg &lt;- replicate(num_t - 1, P0, simplify = FALSE) %&gt;%
  append(list(PA)) %&gt;%
  lapply(sample_sbm, n = num_v, block.sizes = block_sizes, directed = TRUE)

scan_stat(graphs = tsg, k = 1, tau = 4, ell = 2)
scan_stat(graphs = tsg, locality = "them", k = 1, tau = 4, ell = 2)
</pre>

<hr /><div style="text-align: center;">[Package <em>igraph</em> version 1.2.4.1 <a href="00Index.html">Index</a>]</div>



  </div>
  </div>
</div>
</div>


    </div>

    <div id="footer"><div class="container">
      <div class="row">
        <div class="col-xs-12">
          <p class="text-muted credit">
	    &copy; 2003 &ndash; 2020 The igraph core team.
            &bull; Code licensed under 
            <a href="http://www.gnu.org/licenses/gpl-2.0.html">
            GNU GPL 2</a> or later, documentation under 
            <a href="http://www.gnu.org/copyleft/fdl.html">
              GNU FDL.</a>
            <!-- &bull; <a href="">Download old releases</a> -->
            <!-- &bull; <a href="">Old documentation</a> -->
            <!-- &bull; <a href="">Authors</a> -->
            <!-- &bull; <a href="">Tools</a> -->
            <!-- &bull; <a href="">Papers citing igraph</a> -->
          </p>
        </div>
      </div>
    </div></div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery-2.0.3.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="/js/affix.js"></script>
    <script src="/js/tooltips.js"></script>
    <script src="/js/toggle.js"></script>

    
  </body>
</html>
